<!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="1000" viewBox="0 0 1600 1000">

  <defs>
    <!-- Arrowhead for FK relationships -->
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 10 3.5, 0 7"></polygon>
    </marker>

    <style type="text/css">
      .schema-title {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 26px;
        font-weight: bold;
      }
      .schema-subtitle {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 16px;
        fill: #555;
      }
      .table-box {
        fill: #f9fafb;
        stroke: #555;
        stroke-width: 1.2;
      }
      .table-header {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 14px;
        font-weight: bold;
      }
      .table-schema {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 12px;
        fill: #444;
      }
      .column-text {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 11px;
      }
      .column-pk {
        font-weight: bold;
      }
      .column-fk {
        fill: #0b7285;
      }
      .enum-box {
        fill: #fff4e6;
        stroke: #f08c00;
        stroke-width: 1.1;
      }
      .enum-header {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 13px;
        font-weight: bold;
        fill: #d9480f;
      }
      .enum-value {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 11px;
      }
      .zone-label {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 14px;
        font-weight: bold;
        fill: #364fc7;
      }
      .fk-line {
        stroke: #555;
        stroke-width: 1;
        fill: none;
        marker-end: url(#arrow);
      }
    </style>
  </defs>

  <!-- Title -->
  <text x="800" y="40" text-anchor="middle" class="schema-title">
    ArcoirisPOS Schema Overview
  </text>
  <text x="800" y="65" text-anchor="middle" class="schema-subtitle">
    Logical entity &amp; relationship diagram (core / acct / inv / pos)
  </text>

  <!-- Zone Labels -->
  <text x="250" y="110" class="zone-label">core</text>
  <text x="1150" y="110" class="zone-label">acct</text>
  <text x="1150" y="500" class="zone-label">pos</text>
  <text x="250" y="500" class="zone-label">inv</text>

  <!-- ====================== core SCHEMA ====================== -->

  <!-- core.organizations -->
  <rect x="120" y="140" width="260" height="120" rx="8" ry="8" class="table-box"></rect>
  <text x="135" y="160" class="table-header">organizations</text>
  <text x="135" y="178" class="table-schema">core.organizations</text>
  <text x="135" y="200" class="column-text column-pk">PK  org_id : UUID</text>
  <text x="135" y="216" class="column-text">    name : text</text>
  <text x="135" y="232" class="column-text">    base_currency : text</text>
  <text x="135" y="248" class="column-text">    created_at / updated_at</text>

  <!-- core.users -->
  <rect x="120" y="290" width="260" height="120" rx="8" ry="8" class="table-box"></rect>
  <text x="135" y="310" class="table-header">users</text>
  <text x="135" y="328" class="table-schema">core.users</text>
  <text x="135" y="350" class="column-text column-pk">PK  user_id : UUID</text>
  <text x="135" y="366" class="column-text">    email : citext (unique)</text>
  <text x="135" y="382" class="column-text">    password_hash : text</text>
  <text x="135" y="398" class="column-text">    created_at / updated_at</text>

  <!-- core.user_org_roles -->
  <rect x="430" y="210" width="280" height="130" rx="8" ry="8" class="table-box"></rect>
  <text x="445" y="230" class="table-header">user_org_roles</text>
  <text x="445" y="248" class="table-schema">core.user_org_roles</text>
  <text x="445" y="270" class="column-text column-pk">PK  user_org_role_id : UUID</text>
  <text x="445" y="286" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="445" y="302" class="column-text column-fk">FK  user_id → core.users.user_id</text>
  <text x="445" y="318" class="column-text">    role : text, is_primary : bool</text>

  <!-- ====================== acct SCHEMA ====================== -->

  <!-- acct.chart_of_accounts -->
  <rect x="980" y="140" width="280" height="150" rx="8" ry="8" class="table-box"></rect>
  <text x="995" y="160" class="table-header">chart_of_accounts</text>
  <text x="995" y="178" class="table-schema">acct.chart_of_accounts</text>
  <text x="995" y="200" class="column-text column-pk">PK  account_id : UUID</text>
  <text x="995" y="216" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="995" y="232" class="column-text column-fk">FK  parent_id → acct.chart_of_accounts.account_id</text>
  <text x="995" y="248" class="column-text">    code : text, name : text</text>
  <text x="995" y="264" class="column-text">    type / subtype, is_active</text>

  <!-- acct.journal_entries -->
  <rect x="980" y="310" width="280" height="150" rx="8" ry="8" class="table-box"></rect>
  <text x="995" y="330" class="table-header">journal_entries</text>
  <text x="995" y="348" class="table-schema">acct.journal_entries</text>
  <text x="995" y="370" class="column-text column-pk">PK  journal_id : UUID</text>
  <text x="995" y="386" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="995" y="402" class="column-text column-fk">FK  created_by → core.users.user_id</text>
  <text x="995" y="418" class="column-text">    journal_date : date, posted : bool</text>

  <!-- acct.journal_lines -->
  <rect x="1290" y="290" width="280" height="170" rx="8" ry="8" class="table-box"></rect>
  <text x="1305" y="310" class="table-header">journal_lines</text>
  <text x="1305" y="328" class="table-schema">acct.journal_lines</text>
  <text x="1305" y="350" class="column-text column-pk">PK  journal_line_id : UUID</text>
  <text x="1305" y="366" class="column-text column-fk">FK  journal_id → acct.journal_entries.journal_id</text>
  <text x="1305" y="382" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="1305" y="398" class="column-text column-fk">FK  account_id → acct.chart_of_accounts.account_id</text>
  <text x="1305" y="414" class="column-text column-fk">enum entry_type → acct.acct_entry_type</text>
  <text x="1305" y="430" class="column-text">    amount : numeric(18,4) CHECK &gt; 0</text>

  <!-- acct.bank_accounts -->
  <rect x="980" y="480" width="280" height="130" rx="8" ry="8" class="table-box"></rect>
  <text x="995" y="500" class="table-header">bank_accounts</text>
  <text x="995" y="518" class="table-schema">acct.bank_accounts</text>
  <text x="995" y="540" class="column-text column-pk">PK  bank_account_id : UUID</text>
  <text x="995" y="556" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="995" y="572" class="column-text column-fk">FK  account_id → acct.chart_of_accounts.account_id</text>

  <!-- acct.customer_balances -->
  <rect x="1290" y="500" width="280" height="150" rx="8" ry="8" class="table-box"></rect>
  <text x="1305" y="520" class="table-header">customer_balances</text>
  <text x="1305" y="538" class="table-schema">acct.customer_balances</text>
  <text x="1305" y="560" class="column-text column-pk">PK  customer_balance_id : UUID</text>
  <text x="1305" y="576" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="1305" y="592" class="column-text column-fk">FK  customer_id → pos.customers.customer_id</text>
  <text x="1305" y="608" class="column-text column-fk">FK  account_id → acct.chart_of_accounts.account_id</text>

  <!-- acct.acct_entry_type ENUM -->
  <rect x="1310" y="190" width="170" height="80" rx="8" ry="8" class="enum-box"></rect>
  <text x="1320" y="210" class="enum-header">acct.acct_entry_type</text>
  <text x="1320" y="232" class="enum-value">• debit</text>
  <text x="1320" y="248" class="enum-value">• credit</text>

  <!-- ====================== pos SCHEMA ====================== -->

  <!-- pos.customers -->
  <rect x="980" y="660" width="280" height="140" rx="8" ry="8" class="table-box"></rect>
  <text x="995" y="680" class="table-header">customers</text>
  <text x="995" y="698" class="table-schema">pos.customers</text>
  <text x="995" y="720" class="column-text column-pk">PK  customer_id : UUID</text>
  <text x="995" y="736" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="995" y="752" class="column-text">    full_name : text</text>
  <text x="995" y="768" class="column-text">    email : citext, phone, JSONB addresses</text>

  <!-- pos.tax_rates -->
  <rect x="1290" y="670" width="280" height="120" rx="8" ry="8" class="table-box"></rect>
  <text x="1305" y="690" class="table-header">tax_rates</text>
  <text x="1305" y="708" class="table-schema">pos.tax_rates</text>
  <text x="1305" y="730" class="column-text column-pk">PK  tax_id : UUID</text>
  <text x="1305" y="746" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="1305" y="762" class="column-text">    name, rate_percent, is_default</text>

  <!-- pos.terminals -->
  <rect x="980" y="830" width="280" height="120" rx="8" ry="8" class="table-box"></rect>
  <text x="995" y="850" class="table-header">terminals</text>
  <text x="995" y="868" class="table-schema">pos.terminals</text>
  <text x="995" y="890" class="column-text column-pk">PK  terminal_id : UUID</text>
  <text x="995" y="906" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="995" y="922" class="column-text">    name, location_label, is_active</text>

  <!-- pos.sales -->
  <rect x="1290" y="830" width="280" height="180" rx="8" ry="8" class="table-box"></rect>
  <text x="1305" y="850" class="table-header">sales</text>
  <text x="1305" y="868" class="table-schema">pos.sales</text>
  <text x="1305" y="890" class="column-text column-pk">PK  sale_id : UUID</text>
  <text x="1305" y="906" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="1305" y="922" class="column-text column-fk">FK  terminal_id → pos.terminals.terminal_id</text>
  <text x="1305" y="938" class="column-text column-fk">FK  customer_id → pos.customers.customer_id</text>
  <text x="1305" y="954" class="column-text column-fk">FK  created_by → core.users.user_id</text>
  <!-- (totals and dates not listed to save space) -->

  <!-- pos.payments -->
  <rect x="1290" y="1030" width="280" height="120" rx="8" ry="8" class="table-box"></rect>
  <!-- Note: falls out of viewBox, but kept for logical completeness if you later enlarge canvas -->

  <!-- pos.sale_lines -->
  <rect x="1600" y="830" width="280" height="170" rx="8" ry="8" class="table-box"></rect>
  <!-- (also outside initial viewBox; included conceptually only) -->

  <!-- For SVG size reasons, we’re omitting explicit drawing for payments & sale_lines here,
       but the relational structure is reflected in the acct.customer_balances FK and sales FK. -->

  <!-- ====================== inv SCHEMA ====================== -->

  <!-- inv.locations -->
  <rect x="120" y="540" width="260" height="120" rx="8" ry="8" class="table-box"></rect>
  <text x="135" y="560" class="table-header">locations</text>
  <text x="135" y="578" class="table-schema">inv.locations</text>
  <text x="135" y="600" class="column-text column-pk">PK  location_id : UUID</text>
  <text x="135" y="616" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>

  <!-- inv.items -->
  <rect x="430" y="540" width="280" height="150" rx="8" ry="8" class="table-box"></rect>
  <text x="445" y="560" class="table-header">items</text>
  <text x="445" y="578" class="table-schema">inv.items</text>
  <text x="445" y="600" class="column-text column-pk">PK  item_id : UUID</text>
  <text x="445" y="616" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="445" y="632" class="column-text column-fk">FK  tax_id → pos.tax_rates.tax_id</text>
  <text x="445" y="648" class="column-text">    sku, barcode, name, default_price</text>

  <!-- inv.stock_levels -->
  <rect x="120" y="700" width="260" height="140" rx="8" ry="8" class="table-box"></rect>
  <text x="135" y="720" class="table-header">stock_levels</text>
  <text x="135" y="738" class="table-schema">inv.stock_levels</text>
  <text x="135" y="760" class="column-text column-pk">PK  stock_level_id : UUID</text>
  <text x="135" y="776" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="135" y="792" class="column-text column-fk">FK  item_id → inv.items.item_id</text>
  <text x="135" y="808" class="column-text column-fk">FK  location_id → inv.locations.location_id</text>

  <!-- inv.stock_movements -->
  <rect x="430" y="720" width="280" height="160" rx="8" ry="8" class="table-box"></rect>
  <text x="445" y="740" class="table-header">stock_movements</text>
  <text x="445" y="758" class="table-schema">inv.stock_movements</text>
  <text x="445" y="780" class="column-text column-pk">PK  movement_id : UUID</text>
  <text x="445" y="796" class="column-text column-fk">FK  org_id → core.organizations.org_id</text>
  <text x="445" y="812" class="column-text column-fk">FK  item_id → inv.items.item_id</text>
  <text x="445" y="828" class="column-text column-fk">FK  location_id → inv.locations.location_id</text>
  <text x="445" y="844" class="column-text">    source_type, quantity_delta, occurred_at</text>

  <!-- ====================== RELATIONSHIP LINES ====================== -->

  <!-- organizations → chart_of_accounts -->
  <path d="M380 190 C 600 190, 900 190, 980 190" class="fk-line"></path>

  <!-- organizations → users_org_roles -->
  <path d="M380 210 C 410 210, 430 225, 430 250" class="fk-line"></path>

  <!-- users → user_org_roles -->
  <path d="M250 410 C 320 430, 380 410, 430 310" class="fk-line"></path>

  <!-- organizations → users (org_id used indirectly via roles, but we emphasize core as hub) -->
  <!-- (intentionally omitted arrow to avoid clutter) -->

  <!-- organizations → acct.journal_entries -->
  <path d="M380 210 C 650 210, 930 340, 980 360" class="fk-line"></path>

  <!-- users → acct.journal_entries.created_by -->
  <path d="M250 410 C 650 430, 900 390, 980 390" class="fk-line"></path>

  <!-- journal_entries → journal_lines -->
  <path d="M1260 360 C 1280 360, 1290 360, 1290 340" class="fk-line"></path>

  <!-- chart_of_accounts → journal_lines -->
  <path d="M1260 230 C 1350 250, 1390 280, 1420 310" class="fk-line"></path>

  <!-- chart_of_accounts → bank_accounts -->
  <path d="M1120 290 C 1120 340, 1120 460, 1120 480" class="fk-line"></path>

  <!-- organizations → bank_accounts -->
  <path d="M380 210 C 700 260, 950 500, 980 525" class="fk-line"></path>

  <!-- customers → customer_balances -->
  <path d="M1120 740 C 1220 720, 1320 620, 1390 610" class="fk-line"></path>

  <!-- chart_of_accounts → customer_balances -->
  <path d="M1120 290 C 1250 360, 1390 510, 1390 540" class="fk-line"></path>

  <!-- organizations → customers -->
  <path d="M380 210 C 700 260, 950 700, 980 720" class="fk-line"></path>

  <!-- organizations → terminals -->
  <path d="M380 210 C 690 240, 920 860, 980 880" class="fk-line"></path>

  <!-- organizations → tax_rates -->
  <path d="M380 210 C 800 260, 1300 680, 1290 700" class="fk-line"></path>

  <!-- organizations → locations -->
  <path d="M250 260 C 250 360, 250 520, 250 540" class="fk-line"></path>

  <!-- organizations → items -->
  <path d="M380 210 C 510 260, 570 520, 570 540" class="fk-line"></path>

  <!-- tax_rates → items -->
  <path d="M1430 730 C 1200 700, 800 640, 710 640" class="fk-line"></path>

  <!-- locations → stock_levels -->
  <path d="M250 660 C 250 680, 250 700, 250 700" class="fk-line"></path>

  <!-- items → stock_levels -->
  <path d="M570 640 C 480 670, 360 720, 380 750" class="fk-line"></path>

  <!-- locations → stock_movements -->
  <path d="M250 660 C 340 690, 430 740, 430 760" class="fk-line"></path>

  <!-- items → stock_movements -->
  <path d="M710 640 C 700 690, 710 780, 710 780" class="fk-line"></path>

</svg>
